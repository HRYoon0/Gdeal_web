// Swiper.js Creative íš¨ê³¼ ì ìš© ìŠ¤í¬ë¦½íŠ¸ v13
// 2x2 ë ˆì´ì•„ì›ƒ + React ì›ë³¸ ì• ë‹ˆë©”ì´ì…˜ ì™„ì „ ì œê±°
(function() {
  'use strict';

  console.log('ğŸ¨ Swiper Creative ìŠ¤í¬ë¦½íŠ¸ v13 ì‹œì‘ (2x2 ë ˆì´ì•„ì›ƒ)');

  // ì¦‰ì‹œ React ìŠ¬ë¼ì´ë“œì‡¼ ìˆ¨ê¸°ê¸° (zoom íš¨ê³¼ ë°©ì§€)
  const immediateStyle = document.createElement('style');
  immediateStyle.id = 'swiper-immediate-hide';
  immediateStyle.textContent = `
    /* React ìŠ¬ë¼ì´ë“œì‡¼ ì¦‰ì‹œ ìˆ¨ê¹€ - Swiper ì´ˆê¸°í™” ì „ zoom íš¨ê³¼ ë°©ì§€ */
    .relative.bg-gray-200.rounded-2xl > .relative {
      opacity: 0 !important;
      visibility: hidden !important;
    }
  `;
  document.head.appendChild(immediateStyle);

  // 2x2 ë ˆì´ì•„ì›ƒ ìŠ¤íƒ€ì¼ ì¦‰ì‹œ ì ìš©
  const layoutStyle = document.createElement('style');
  layoutStyle.id = 'layout-2x2';
  layoutStyle.textContent = `
    /* ë©”ì¸ ê·¸ë¦¬ë“œë¥¼ 1ì—´ë¡œ ë³€ê²½ - ê° ì„¹ì…˜ì´ ì „ì²´ ë„ˆë¹„ ì°¨ì§€ */
    .max-w-full > .grid.lg\\:grid-cols-2 {
      grid-template-columns: 1fr !important;
    }

    /* êµìœ¡í™œë™(ë‘ ë²ˆì§¸)ì„ ìœ„ë¡œ, ìµœì‹ ì†Œì‹(ì²« ë²ˆì§¸)ì„ ì•„ë˜ë¡œ */
    .max-w-full > .grid > .col-span-1:first-child {
      order: 2 !important;
    }
    .max-w-full > .grid > .col-span-1:last-child {
      order: 1 !important;
    }

    /* ì„¹ì…˜ ê°„ê²© ëŠ˜ë¦¬ê¸° */
    .max-w-full > .grid.lg\\:grid-cols-2 {
      gap: 3.5rem !important;
    }

    /* íƒ€ì´í‹€ í—¤ë” ì»¨í…Œì´ë„ˆ */
    .max-w-full > .grid > .col-span-1 > .relative > .flex.items-center.justify-between.mb-6 {
      padding: 1rem 1.5rem !important;
      background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,250,252,0.95) 100%) !important;
      backdrop-filter: blur(10px) !important;
      border-radius: 1rem !important;
      box-shadow: 0 4px 20px rgba(0,0,0,0.04), 0 1px 3px rgba(0,0,0,0.02) !important;
      border: 1px solid rgba(255,255,255,0.8) !important;
      margin-bottom: 1.5rem !important;
    }

    /* íƒ€ì´í‹€ í…ìŠ¤íŠ¸ */
    .max-w-full > .grid > .col-span-1 > .relative > .flex.items-center.justify-between.mb-6 h2 {
      position: relative !important;
      font-size: 1.5rem !important;
      font-weight: 700 !important;
      letter-spacing: -0.02em !important;
      color: #1a1a2e !important;
      padding-left: 1rem !important;
    }

    /* íƒ€ì´í‹€ ì• ì„¸ë¡œ ê·¸ë¼ë°ì´ì…˜ ë°” */
    .max-w-full > .grid > .col-span-1 > .relative > .flex.items-center.justify-between.mb-6 h2::before {
      content: '' !important;
      position: absolute !important;
      left: 0 !important;
      top: 50% !important;
      transform: translateY(-50%) !important;
      width: 4px !important;
      height: 1.5rem !important;
      background: linear-gradient(180deg, #66ae7d 0%, #4ecdc4 100%) !important;
      border-radius: 2px !important;
    }

    /* ë”ë³´ê¸° ë²„íŠ¼ */
    .max-w-full > .grid > .col-span-1 > .relative > .flex.items-center.justify-between.mb-6 a {
      display: inline-flex !important;
      align-items: center !important;
      gap: 0.4rem !important;
      padding: 0.6rem 1.2rem !important;
      background: linear-gradient(135deg, #66ae7d 0%, #4ecdc4 100%) !important;
      border-radius: 2rem !important;
      font-weight: 600 !important;
      font-size: 0.8rem !important;
      color: white !important;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
      box-shadow: 0 4px 15px rgba(102, 174, 125, 0.3) !important;
      text-decoration: none !important;
    }

    .max-w-full > .grid > .col-span-1 > .relative > .flex.items-center.justify-between.mb-6 a:hover {
      transform: translateY(-2px) scale(1.02) !important;
      box-shadow: 0 8px 25px rgba(102, 174, 125, 0.4) !important;
      background: linear-gradient(135deg, #4ecdc4 0%, #66ae7d 100%) !important;
    }

    /* ê° ì„¹ì…˜ ë‚´ë¶€ë¥¼ 2ì—´ ê·¸ë¦¬ë“œë¡œ ë³€ê²½ */
    .max-w-full > .grid > .col-span-1 > .relative {
      display: grid !important;
      grid-template-columns: 1fr 1fr !important;
      grid-template-rows: auto 1fr !important;
      gap: 1.5rem !important;
    }

    /* í—¤ë”ëŠ” ì „ì²´ ë„ˆë¹„ ì°¨ì§€ */
    .max-w-full > .grid > .col-span-1 > .relative > .flex.items-center.justify-between.mb-6 {
      grid-column: 1 / -1 !important;
    }

    /* ìŠ¬ë¼ì´ë“œì‡¼ ë†’ì´ ì¡°ì • */
    .max-w-full > .grid > .col-span-1 > .relative > .relative.bg-gray-200.rounded-2xl {
      height: 38rem !important;
    }

    /* ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ ì¡°ì • */
    .max-w-full > .grid > .col-span-1 > .relative > .mt-6.space-y-3 {
      margin-top: 0 !important;
      height: 38rem !important;
      overflow-y: auto !important;
      background: #f9fafb !important;
      border-radius: 1rem !important;
      padding: 1rem !important;
    }

    /* ìµœì‹ ì†Œì‹ ì„¹ì…˜ (ì²« ë²ˆì§¸) - ë¦¬ìŠ¤íŠ¸ ì™¼ìª½, ìŠ¬ë¼ì´ë“œì‡¼ ì˜¤ë¥¸ìª½ */
    .max-w-full > .grid > .col-span-1:first-child > .relative > .mt-6.space-y-3 {
      order: 1 !important;
    }
    .max-w-full > .grid > .col-span-1:first-child > .relative > .relative.bg-gray-200.rounded-2xl {
      order: 2 !important;
    }

    /* êµìœ¡í™œë™ ì„¹ì…˜ (ë‘ ë²ˆì§¸) - ìŠ¬ë¼ì´ë“œì‡¼ ì™¼ìª½, ë¦¬ìŠ¤íŠ¸ ì˜¤ë¥¸ìª½ */
    .max-w-full > .grid > .col-span-1:last-child > .relative > .relative.bg-gray-200.rounded-2xl {
      order: 1 !important;
    }
    .max-w-full > .grid > .col-span-1:last-child > .relative > .mt-6.space-y-3 {
      order: 2 !important;
    }

    /* ëª¨ë°”ì¼ì—ì„œëŠ” 1ì—´ ë ˆì´ì•„ì›ƒ ìœ ì§€ */
    @media (max-width: 1024px) {
      .max-w-full > .grid > .col-span-1 > .relative {
        grid-template-columns: 1fr !important;
      }
      .max-w-full > .grid > .col-span-1 > .relative > .relative.bg-gray-200.rounded-2xl,
      .max-w-full > .grid > .col-span-1 > .relative > .mt-6.space-y-3 {
        order: unset !important;
        height: auto !important;
      }
      .max-w-full > .grid > .col-span-1 > .relative > .relative.bg-gray-200.rounded-2xl {
        height: 24rem !important;
      }
      .max-w-full > .grid > .col-span-1 > .relative > .mt-6.space-y-3 {
        margin-top: 1.5rem !important;
        height: auto !important;
        max-height: 20rem !important;
      }
    }
  `;
  document.head.appendChild(layoutStyle);

  // Firebase ì„¤ì •
  const FIREBASE_PROJECT_ID = 'gdeal-page-a67e2';
  const FIREBASE_API_KEY = 'AIzaSyBJsqUJK1AjhrLNzIY_79dIR2Mlg7zD09w';

  // Firebase Firestore REST APIë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
  async function fetchFirestoreCollection(collection, orderBy = 'date', orderDir = 'DESCENDING', limit = 5, dateFilter = null) {
    const baseUrl = `https://firestore.googleapis.com/v1/projects/${FIREBASE_PROJECT_ID}/databases/(default)/documents`;

    try {
      // êµ¬ì¡°í™”ëœ ì¿¼ë¦¬ ì‚¬ìš©
      const queryUrl = `${baseUrl}:runQuery?key=${FIREBASE_API_KEY}`;

      const structuredQuery = {
        from: [{ collectionId: collection }],
        orderBy: [{ field: { fieldPath: orderBy }, direction: orderDir }],
        limit: limit
      };

      // ë‚ ì§œ í•„í„° ì¶”ê°€ (trainingsìš©: ì˜¤ëŠ˜ ì´í›„ ë‚ ì§œë§Œ)
      if (dateFilter) {
        structuredQuery.where = {
          fieldFilter: {
            field: { fieldPath: 'date' },
            op: 'GREATER_THAN_OR_EQUAL',
            value: { stringValue: dateFilter }
          }
        };
      }

      const query = { structuredQuery };

      const response = await fetch(queryUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(query)
      });

      if (!response.ok) {
        throw new Error(`Firestore API ì˜¤ë¥˜: ${response.status}`);
      }

      const data = await response.json();

      // Firestore ì‘ë‹µì„ ì¼ë°˜ ê°ì²´ë¡œ ë³€í™˜
      return data
        .filter(item => item.document)
        .map(item => {
          const doc = item.document;
          const fields = doc.fields;
          const id = doc.name.split('/').pop();

          return {
            id,
            title: fields.title?.stringValue || '',
            description: fields.description?.stringValue || '',
            date: fields.date?.stringValue || '',
            location: fields.location?.stringValue || '',
            category: fields.category?.stringValue || '',
            images: fields.images?.arrayValue?.values?.map(v => v.stringValue) || []
          };
        });
    } catch (error) {
      console.error(`Firestore ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨ (${collection}):`, error);
      return [];
    }
  }

  // Google Drive URLì„ ì¸ë„¤ì¼ URLë¡œ ë³€í™˜
  function convertToThumbnailUrl(url) {
    if (!url) return '';
    const match = url.match(/https:\/\/drive\.google\.com\/file\/d\/([a-zA-Z0-9_-]+)/);
    if (match && match[1]) {
      return `https://drive.google.com/thumbnail?id=${match[1]}&sz=w1000`;
    }
    return url;
  }

  // Swiper CSS ë™ì  ë¡œë“œ
  const swiperCSS = document.createElement('link');
  swiperCSS.rel = 'stylesheet';
  swiperCSS.href = 'https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css';
  document.head.appendChild(swiperCSS);

  // ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ ì¶”ê°€
  const customStyle = document.createElement('style');
  customStyle.textContent = `
    /* Swiperê°€ ì ìš©ëœ ì»¨í…Œì´ë„ˆëŠ” React ì›ë³¸ ìš”ì†Œ ì™„ì „ ìˆ¨ê¹€ */
    .relative.bg-gray-200.rounded-2xl:has(.swiper-creative-container) > :not(.swiper-creative-container) {
      display: none !important;
      opacity: 0 !important;
      visibility: hidden !important;
    }

    /* Swiper ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
    .swiper-creative-container {
      width: 100%;
      height: 100%;
      border-radius: 1rem;
      overflow: hidden;
      position: relative;
    }

    .swiper-creative-container .swiper {
      width: 100%;
      height: 100%;
    }

    .swiper-creative-container .swiper-slide {
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 1rem;
      overflow: hidden;
      position: relative;
    }

    .swiper-creative-container .swiper-slide img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      position: absolute;
      inset: 0;
    }

    /* Swiper ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ì»¤ìŠ¤í…€ */
    .swiper-creative-container .swiper-button-next,
    .swiper-creative-container .swiper-button-prev {
      width: 52px !important;
      height: 52px !important;
      background: rgba(255, 255, 255, 0.95) !important;
      border-radius: 50% !important;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15), 0 2px 8px rgba(0, 0, 0, 0.1);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
      opacity: 0;
    }

    .swiper-creative-container:hover .swiper-button-next,
    .swiper-creative-container:hover .swiper-button-prev {
      opacity: 1;
    }

    .swiper-creative-container .swiper-button-next:hover,
    .swiper-creative-container .swiper-button-prev:hover {
      transform: scale(1.1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }

    .swiper-creative-container .swiper-button-next::after,
    .swiper-creative-container .swiper-button-prev::after {
      font-size: 1.125rem !important;
      color: #66ae7d !important;
      font-weight: 700 !important;
    }

    /* Swiper í˜ì´ì§€ë„¤ì´ì…˜ */
    .swiper-creative-container .swiper-pagination {
      bottom: 1.25rem !important;
    }

    .swiper-creative-container .swiper-pagination-bullet {
      width: 10px !important;
      height: 10px !important;
      background: rgba(255, 255, 255, 0.5) !important;
      opacity: 1 !important;
      transition: all 0.3s ease !important;
      margin: 0 6px !important;
    }

    .swiper-creative-container .swiper-pagination-bullet-active {
      background: white !important;
      transform: scale(1.3);
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    /* ë°˜ì‘í˜• */
    @media (max-width: 768px) {
      .swiper-creative-container .swiper-button-next,
      .swiper-creative-container .swiper-button-prev {
        width: 40px !important;
        height: 40px !important;
        opacity: 1;
      }
    }

    /* ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ (ì´ë¯¸ì§€ ì—†ì„ ë•Œ) */
    .slide-gradient-bg {
      background: linear-gradient(135deg, #66ae7d 0%, #497e56 50%, #3a6b47 100%);
    }
  `;
  document.head.appendChild(customStyle);

  // Swiper JS ë™ì  ë¡œë“œ
  const swiperScript = document.createElement('script');
  swiperScript.src = 'https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js';
  document.body.appendChild(swiperScript);

  // ì „ì—­ Swiper ì¸ìŠ¤í„´ìŠ¤ ì €ì¥
  const swiperInstances = {};

  // ë™ê¸°í™” ì¤‘ í”Œë˜ê·¸ (ë¬´í•œ ë£¨í”„ ë°©ì§€)
  let isSyncing = false;

  // Swiper ë¡œë“œ ì™„ë£Œ í›„ ì´ˆê¸°í™”
  swiperScript.onload = function() {
    console.log('âœ… Swiper.js ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì™„ë£Œ');
    waitForSlideshowAndInit();
  };

  // ìŠ¬ë¼ì´ë“œì‡¼ ë Œë”ë§ ì™„ë£Œ ëŒ€ê¸° í›„ Swiper ì ìš©
  function waitForSlideshowAndInit() {
    let checkCount = 0;
    const maxChecks = 100;

    const checkInterval = setInterval(() => {
      checkCount++;

      const newsSection = findSectionByTitle('ìµœì‹  ì†Œì‹');
      const eventsSection = findSectionByTitle('êµìœ¡ í™œë™');

      let newsReady = isSectionReady(newsSection);
      let eventsReady = isSectionReady(eventsSection);

      if (newsReady || eventsReady) {
        clearInterval(checkInterval);
        console.log(`ğŸ  ìŠ¬ë¼ì´ë“œì‡¼ ì¤€ë¹„ ì™„ë£Œ (${checkCount * 100}ms ëŒ€ê¸°)`);

        setTimeout(() => {
          if (newsReady) initSwiperForSection(newsSection, 'news');
          if (eventsReady) initSwiperForSection(eventsSection, 'events');
        }, 500);
      }

      if (checkCount >= maxChecks) {
        clearInterval(checkInterval);
        console.log('âš ï¸ ìŠ¬ë¼ì´ë“œì‡¼ ë¡œë”© íƒ€ì„ì•„ì›ƒ');
      }
    }, 100);
  }

  // ì„¹ì…˜ ì¤€ë¹„ ìƒíƒœ í™•ì¸
  function isSectionReady(section) {
    if (!section) return false;
    const container = section.querySelector('.relative.bg-gray-200.rounded-2xl');
    if (!container) return false;
    const hasSpinner = container.querySelector('.animate-spin');
    const hasImage = container.querySelector('img');
    const hasList = section.querySelector('.mt-6.space-y-3');
    return !hasSpinner && hasImage && hasList;
  }

  // ì œëª©ìœ¼ë¡œ ì„¹ì…˜ ì°¾ê¸°
  function findSectionByTitle(title) {
    const headers = document.querySelectorAll('h2');
    for (const header of headers) {
      if (header.textContent.trim() === title) {
        return header.closest('.col-span-1') || header.closest('.relative');
      }
    }
    return null;
  }

  // ì„¹ì…˜ì— Swiper ì ìš© (Firebase ë°ì´í„° ì‚¬ìš©)
  async function initSwiperForSection(section, type) {
    const container = section.querySelector('.relative.bg-gray-200.rounded-2xl');
    if (!container || container.querySelector('.swiper-creative-container')) return;

    console.log(`ğŸ“¦ ${type} ì„¹ì…˜ Firebase ë°ì´í„° ë¡œë“œ ì‹œì‘`);

    // ê¸°ì¡´ í•˜ë‹¨ ë¦¬ìŠ¤íŠ¸ ì°¾ê¸°
    const listContainer = section.querySelector('.mt-6.space-y-3');
    if (!listContainer) {
      console.log(`âš ï¸ ${type}: í•˜ë‹¨ ë¦¬ìŠ¤íŠ¸ ì—†ìŒ`);
      return;
    }

    // Firebaseì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    let firestoreData = [];
    if (type === 'events') {
      // êµìœ¡ í™œë™: events ì»¬ë ‰ì…˜ì—ì„œ ìµœì‹  5ê°œ (ë‚ ì§œ ë‚´ë¦¼ì°¨ìˆœ)
      firestoreData = await fetchFirestoreCollection('events', 'date', 'DESCENDING', 5);
    } else if (type === 'news') {
      // ìµœì‹  ì†Œì‹: trainings (ì›”ë³„ì—°ìˆ˜) ì»¬ë ‰ì…˜ì—ì„œ ì˜¤ëŠ˜ ì´í›„ ë‚ ì§œë¡œ 5ê°œ (ë‚ ì§œ ì˜¤ë¦„ì°¨ìˆœ)
      const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD í˜•ì‹
      firestoreData = await fetchFirestoreCollection('trainings', 'date', 'ASCENDING', 5, today);
    }

    if (firestoreData.length === 0) {
      console.log(`âš ï¸ ${type}: Firebase ë°ì´í„° ì—†ìŒ, DOMì—ì„œ ì¶”ì¶œ ì‹œë„`);
      // Fallback: DOMì—ì„œ ë°ì´í„° ì¶”ì¶œ
      const listItems = listContainer.querySelectorAll('a');
      listItems.forEach((item, index) => {
        const titleEl = item.querySelector('.text-sm.font-medium.text-gray-900');
        const title = titleEl?.textContent?.trim() || '';
        if (title) {
          firestoreData.push({
            id: index.toString(),
            title,
            date: '',
            location: '',
            category: '',
            images: []
          });
        }
      });
    }

    console.log(`ğŸ“Š ${type}: Firebaseì—ì„œ ${firestoreData.length}ê°œ ë°ì´í„° ë¡œë“œë¨`);

    // ìŠ¬ë¼ì´ë“œ ë°ì´í„° ìƒì„±
    const slideData = firestoreData.map((item, index) => {
      // ì²« ë²ˆì§¸ ì´ë¯¸ì§€ë¥¼ ëŒ€í‘œ ì´ë¯¸ì§€ë¡œ ì‚¬ìš©
      const imageUrl = item.images && item.images.length > 0
        ? convertToThumbnailUrl(item.images[0])
        : '';

      return {
        index,
        id: item.id,
        title: item.title,
        category: item.category || '',
        date: item.date ? item.date.replace(/-/g, '.') : '',
        location: item.location || '',
        description: item.description || '',
        image: imageUrl
      };
    });

    console.log(`ğŸ–¼ï¸ ${type}: ìŠ¬ë¼ì´ë“œ ë°ì´í„° ìƒì„± ì™„ë£Œ`, slideData.map(s => ({ title: s.title, image: s.image ? 'ìˆìŒ' : 'ì—†ìŒ' })));

    // Swiper ìƒì„±
    createSwiperFromData(container, listContainer, slideData, type);
  }

  // ìˆ˜ì§‘ëœ ë°ì´í„°ë¡œ Swiper ìƒì„±
  function createSwiperFromData(container, listContainer, slideData, type) {
    if (container.querySelector('.swiper-creative-container')) return;

    // ê¸°ì¡´ ìŠ¬ë¼ì´ë“œì‡¼ ì˜ì—­ë§Œ Swiperë¡œ êµì²´
    const swiperHTML = createSwiperHTML(type, slideData);
    container.innerHTML = swiperHTML;

    // Swiper ì´ˆê¸°í™”
    const swiperElement = container.querySelector('.swiper');
    if (swiperElement && window.Swiper) {
      const config = type === 'news' ? getNewsConfig() : getEventsConfig();

      // ìŠ¬ë¼ì´ë“œ ë³€ê²½ ì‹œ ë¦¬ìŠ¤íŠ¸ ë™ê¸°í™”
      config.on = {
        slideChange: function() {
          const realIndex = this.realIndex;
          syncListWithSwiper(listContainer, realIndex);
        },
        init: function() {
          // ì´ˆê¸°í™” ì‹œ ì²« ë²ˆì§¸ ì•„ì´í…œ í™œì„±í™”
          syncListWithSwiper(listContainer, 0);
        }
      };

      const swiper = new window.Swiper(swiperElement, config);
      swiperInstances[type] = swiper;

      // ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ í´ë¦­ ì‹œ Swiper ì´ë™
      setupListClickEvents(listContainer, swiper);

      // Reactì˜ ìì²´ ìƒíƒœ ë³€ê²½ì„ ë¬´ì‹œí•˜ê¸° ìœ„í•œ MutationObserver ì„¤ì •
      setupReactOverride(listContainer, swiper);

      // Swiper ì»¨í…Œì´ë„ˆ í‘œì‹œ (ì¦‰ì‹œ ìˆ¨ê¹€ ìŠ¤íƒ€ì¼ ì œê±°)
      container.style.opacity = '1';
      container.style.visibility = 'visible';

      console.log(`âœ¨ ${type} Swiper Creative íš¨ê³¼ ì ìš© ì™„ë£Œ`);
    }
  }

  // React ìƒíƒœ ë³€ê²½ ê°ì§€ ë° Swiper ìƒíƒœë¡œ ë®ì–´ì“°ê¸°
  function setupReactOverride(listContainer, swiper) {
    if (!listContainer) return;

    // MutationObserverë¡œ Reactì˜ í´ë˜ìŠ¤ ë³€ê²½ ê°ì§€
    const observer = new MutationObserver((mutations) => {
      // ë™ê¸°í™” ì¤‘ì´ë©´ ë¬´ì‹œ (ë¬´í•œ ë£¨í”„ ë°©ì§€)
      if (isSyncing) return;

      // í˜„ì¬ Swiper ì¸ë±ìŠ¤ë¡œ ê°•ì œ ë™ê¸°í™”
      const currentIndex = swiper.realIndex;

      // ì§§ì€ ë”œë ˆì´ í›„ ë™ê¸°í™” (React ë Œë”ë§ ì™„ë£Œ í›„)
      requestAnimationFrame(() => {
        syncListWithSwiper(listContainer, currentIndex);
      });
    });

    // ë¦¬ìŠ¤íŠ¸ ë‚´ ëª¨ë“  div ìš”ì†Œì˜ class ì†ì„± ë³€ê²½ ê°ì‹œ
    const listItems = listContainer.querySelectorAll('a');
    listItems.forEach(item => {
      const innerDiv = item.querySelector('div.flex');
      if (innerDiv) {
        observer.observe(innerDiv, {
          attributes: true,
          attributeFilter: ['class']
        });
      }
    });

    console.log('ğŸ”’ React ìƒíƒœ ì˜¤ë²„ë¼ì´ë“œ ì„¤ì • ì™„ë£Œ');
  }

  // Swiper HTML ìƒì„±
  function createSwiperHTML(type, slides) {
    const slidesHTML = slides.map((slide, index) => {
      const hasImage = slide.image && !slide.image.includes('placeholder');

      return `
        <div class="swiper-slide ${!hasImage ? 'slide-gradient-bg' : ''}" data-index="${index}">
          ${hasImage ? `<img src="${slide.image}" alt="${slide.title}" loading="lazy">` : ''}
        </div>
      `;
    }).join('');

    return `
      <div class="swiper-creative-container">
        <div class="swiper" id="${type}-swiper">
          <div class="swiper-wrapper">
            ${slidesHTML}
          </div>
          <div class="swiper-button-prev"></div>
          <div class="swiper-button-next"></div>
          <div class="swiper-pagination"></div>
        </div>
      </div>
    `;
  }

  // ë¦¬ìŠ¤íŠ¸ì™€ Swiper ë™ê¸°í™” - ê¸°ì¡´ React í´ë˜ìŠ¤ ì •í™•íˆ ë³µì›
  function syncListWithSwiper(listContainer, activeIndex) {
    if (!listContainer) return;

    // ë™ê¸°í™” ì‹œì‘ í”Œë˜ê·¸ ì„¤ì •
    isSyncing = true;

    const listItems = listContainer.querySelectorAll('a');

    listItems.forEach((item, index) => {
      // ë‚´ë¶€ div ìš”ì†Œ ì°¾ê¸° (ì‹¤ì œ ìŠ¤íƒ€ì¼ì´ ì ìš©ëœ ìš”ì†Œ)
      const innerDiv = item.querySelector('div.flex');
      if (!innerDiv) return;

      // ê¸°ë³¸ í´ë˜ìŠ¤ (í•­ìƒ ìœ ì§€)
      const baseClasses = 'flex items-center space-x-4 p-3 rounded-xl cursor-pointer transition-all duration-300';

      // í™œì„±/ë¹„í™œì„± í´ë˜ìŠ¤
      const activeClasses = 'bg-white border-l-4 border-gdeal-primary shadow-lg';
      const inactiveClasses = 'hover:bg-gray-50 hover:shadow-sm';

      if (index === activeIndex) {
        // Active ìƒíƒœ: í™œì„± í´ë˜ìŠ¤ ì ìš©
        innerDiv.className = `${baseClasses} ${activeClasses}`;
      } else {
        // ë¹„í™œì„± ìƒíƒœ: hover í´ë˜ìŠ¤ ì ìš©
        innerDiv.className = `${baseClasses} ${inactiveClasses}`;
      }
    });

    // ë™ê¸°í™” ì™„ë£Œ í›„ í”Œë˜ê·¸ í•´ì œ (ë‹¤ìŒ í”„ë ˆì„ì—ì„œ)
    requestAnimationFrame(() => {
      isSyncing = false;
    });
  }

  // ë¦¬ìŠ¤íŠ¸ í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì •
  function setupListClickEvents(listContainer, swiper) {
    if (!listContainer) return;

    const listItems = listContainer.querySelectorAll('a');

    listItems.forEach((item, index) => {
      // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€ (ê¸°ì¡´ ì´ë²¤íŠ¸ ìœ ì§€í•˜ë©´ì„œ)
      item.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();

        // Swiper ìŠ¬ë¼ì´ë“œ ì´ë™
        swiper.slideToLoop(index, 700);

        console.log(`ğŸ–±ï¸ ë¦¬ìŠ¤íŠ¸ í´ë¦­: ${index}ë²ˆì§¸ ìŠ¬ë¼ì´ë“œë¡œ ì´ë™`);
      }, true); // capture ëª¨ë“œë¡œ ë¨¼ì € ì²˜ë¦¬
    });
  }

  // ìµœì‹  ì†Œì‹: íšŒì „ + ì´ë™ (ì¢Œìš° 125% ì´ë™ + Zì¶• 20ë„ íšŒì „)
  function getNewsConfig() {
    return {
      effect: 'creative',
      grabCursor: true,
      loop: true,
      speed: 700,
      autoplay: {
        delay: 4000,
        disableOnInteraction: false,
        pauseOnMouseEnter: true,
      },
      creativeEffect: {
        perspective: true,
        limitProgress: 2,
        prev: {
          translate: ['-125%', 0, 0],
          rotate: [0, 0, -20],  // Zì¶• -20ë„ íšŒì „
          opacity: 0,
        },
        next: {
          translate: ['125%', 0, 0],
          rotate: [0, 0, 20],  // Zì¶• 20ë„ íšŒì „
          opacity: 0,
        },
      },
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
        dynamicBullets: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
    };
  }

  // êµìœ¡ í™œë™: 3D íšŒì „ (Yì¶• 30ë„ íšŒì „ + ë’¤ë¡œ 500px ì´ë™ + ê·¸ë¦¼ì)
  function getEventsConfig() {
    return {
      effect: 'creative',
      grabCursor: true,
      loop: true,
      speed: 700,
      autoplay: {
        delay: 4000,
        disableOnInteraction: false,
        pauseOnMouseEnter: true,
      },
      creativeEffect: {
        perspective: true,
        limitProgress: 2,
        shadowPerProgress: true,  // ê·¸ë¦¼ì íš¨ê³¼
        prev: {
          translate: [0, 0, -500],
          rotate: [0, 30, 0],  // Yì¶• 30ë„ íšŒì „
          opacity: 0.5,
        },
        next: {
          translate: [0, 0, -500],
          rotate: [0, -30, 0],  // Yì¶• -30ë„ íšŒì „
          opacity: 0.5,
        },
      },
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
        dynamicBullets: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
    };
  }

  console.log('ğŸ“ Swiper Creative ìŠ¤í¬ë¦½íŠ¸ v12 ì´ˆê¸°í™” ì™„ë£Œ');
})();
